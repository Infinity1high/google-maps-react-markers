import { forwardRef, useRef, useState, useCallback, useEffect, useMemo, Children, isValidElement, cloneElement } from 'react';
import { createPortal } from 'react-dom';
import { jsx, jsxs, Fragment } from 'react/jsx-runtime';

var x={};function X(e){let r=document.querySelector(`script[src="${e}"]`),n=r==null?void 0:r.getAttribute("data-status");return {node:r,status:n}}function Y(e={src:"",attributes:{},callbacks:{onLoadCallback:()=>{},onErrorCallback:()=>{}},elementIdToAppend:""},r,n={removeOnUnmount:!1,shouldPreventLoad:!1}){let[l,s]=useState(()=>!e.src||n!=null&&n.shouldPreventLoad?"idle":typeof window>"u"?"loading":x[e.src]??"loading");return useEffect(()=>{var g,a,d;if(r){s(r);return}if(!(e!=null&&e.src)||n!=null&&n.shouldPreventLoad)return;let i=x[e.src];if(i==="ready"||i==="error"){s(i);return}let c=X(e.src),t=c.node;if(t){let p=c.status??i??"loading";switch(p){case"loading":case"ready":(a=e.callbacks)!=null&&a.onLoadCallback&&e.callbacks.onLoadCallback();break;case"error":(d=e.callbacks)!=null&&d.onErrorCallback&&e.callbacks.onErrorCallback();break;}s(p);}else {t=document.createElement("script"),t.src=e.src,t.async=!0,t.setAttribute("data-status","loading"),e.attributes&&Object.entries(e.attributes).length>0&&Object.entries(e.attributes).map(([u,m])=>t==null?void 0:t.setAttribute(u,m)),e.elementIdToAppend&&document.getElementById(e.elementIdToAppend)?(g=document.getElementById(e.elementIdToAppend))==null||g.appendChild(t):document.body.appendChild(t);let p=u=>{let m=u.type==="load"?"ready":"error";t==null||t.setAttribute("data-status",m);};t.addEventListener("load",p),t.addEventListener("error",p);}let o=p=>{var m,f;let u=p.type==="load"?"ready":"error";p.type==="load"?(m=e.callbacks)!=null&&m.onLoadCallback&&e.callbacks.onLoadCallback():(f=e.callbacks)!=null&&f.onErrorCallback&&e.callbacks.onErrorCallback(),s(u),x[e.src]=u;};return t.addEventListener("load",o),t.addEventListener("error",o),()=>{t&&(t.removeEventListener("load",o),t.removeEventListener("error",o)),t&&(n!=null&&n.removeOnUnmount)&&t.remove();}},[e,r,l]),l}var D=Y;var O=({apiKey:e,libraries:r=[],loadScriptExternally:n=!1,status:l="idle",externalApiParams:s,callback:i})=>{var o;typeof window<"u"&&(window.googleMapsCallback=i);let c=(o=new URLSearchParams(s))==null?void 0:o.toString(),t=e?{src:`https://maps.googleapis.com/maps/api/js?key=${e}&callback=googleMapsCallback&libraries=${r==null?void 0:r.join(",")}${c?`&${c}`:""}`,attributes:{id:"googleMapsApi"}}:{src:`https://maps.googleapis.com/maps/api/js?callback=googleMapsCallback&libraries=${r==null?void 0:r.join(",")}`,attributes:{id:"googleMapsApi"}};return D(t,n?l:void 0)};var R=(e,r,n=1e-6)=>{if(e&&r){for(let l=0;l!==e.length;++l)if(Math.abs(e[l]-r[l])>n)return !1;return !0}return !1};var Q=(e,r)=>{let n=useRef(),l=n.current,s=r(l,e);return useEffect(()=>{s||(n.current=e);}),s?l:e},T=Q;var h=e=>{try{return {lat:e==null?void 0:e.lat(),lng:e==null?void 0:e.lng()}}catch{return e}},Z=({container:e,pane:r,position:n,maps:l,drag:s})=>{class i extends google.maps.OverlayView{onAdd=()=>{var g;let t=this;s!=null&&s.draggable&&(this.get("map").getDiv().addEventListener("mouseleave",()=>{google.maps.event.trigger(this.container,"mouseup");}),this.container.addEventListener("mousedown",a=>{var d;this.container.style.cursor="grabbing",(d=t.map)==null||d.set("draggable",!1),t.set("origin",a),s.onDragStart(a,{latLng:h(this.position)}),t.moveHandler=this.get("map").getDiv().addEventListener("mousemove",p=>{let u=t.get("origin"),m=u.clientX-p.clientX,f=u.clientY-p.clientY,L=t.getProjection().fromLatLngToDivPixel(t.position);if(L===null)return;let M=t.getProjection().fromDivPixelToLatLng(new l.Point(L.x-m,L.y-f));t.set("position",M),t.set("origin",p),t.draw(),s.onDrag(p,{latLng:h(M)});});}),this.container.addEventListener("mouseup",a=>{var d;(d=t.map)==null||d.set("draggable",!0),this.container.style.cursor="default",t.moveHandler&&(google.maps.event.removeListener(t.moveHandler),t.moveHandler=null),s.onDragEnd(a,{latLng:h(t.position)});}));let o=(g=this.getPanes())==null?void 0:g[this.pane];o==null||o.classList.add("google-map-markers-overlay"),o==null||o.appendChild(this.container);};draw=()=>{let o=this.getProjection().fromLatLngToDivPixel(this.position);o!==null&&(this.container.style.transform=`translate(${o.x}px, ${o.y}px)`,this.container.style.width="0px",this.container.style.height="0px");};onRemove=()=>{this.container.parentNode!==null&&(google.maps.event.clearInstanceListeners(this.container),this.container.parentNode.removeChild(this.container));};container;pane;position;map=this.getMap();moveHandler;constructor(t,o,g){super(),this.container=t,this.pane=o,this.position=g,this.moveHandler=null;}}return new i(e,r,n)},H=Z;var ee=({pane:e="floatPane",position:r,map:n,maps:l,zIndex:s=0,children:i,drag:c})=>{let t=useMemo(()=>{let a=document.createElement("div");return a.style.position="absolute",a},[]),o=useMemo(()=>H({container:t,pane:e,position:r,maps:l,drag:c}),[t,c,l,e,r]),g=T(i==null?void 0:i.props,(a,d)=>a&&a.lat===d.lat&&a.lng===d.lng);return useEffect(()=>!o.map&&n?(o==null||o.setMap(n),()=>{o==null||o.setMap(null);}):()=>{},[n,g]),useEffect(()=>{t.style.zIndex=`${s}`;},[s,t]),createPortal(i,t)},G=ee;var S=()=>{},ne=({children:e,map:r,maps:n})=>{let l=useMemo(()=>!r||!n?[]:Children.map(e,s=>{if(isValidElement(s)){let i={lat:s.props.lat,lng:s.props.lng},{zIndex:c,draggable:t=!1,onDragStart:o=S,onDrag:g=S,onDragEnd:a=S}=s.props||{};return s=cloneElement(s,{...s.props,draggable:void 0,onDragStart:void 0,onDrag:void 0,onDragEnd:void 0}),jsx(G,{position:new n.LatLng(i.lat,i.lng),map:r,maps:n,zIndex:c,drag:{draggable:t,onDragStart:o,onDrag:g,onDragEnd:a},children:s})}return null}),[e,r,n]);return jsx("div",{children:l})},j=ne;function le({children:e=null,style:r={width:"100%",height:"100%",left:0,top:0,margin:0,padding:0,position:"absolute"},defaultCenter:n,defaultZoom:l,onGoogleApiLoaded:s,onChange:i,options:c={},events:t=[]}){let o=useRef(null),g=useRef(),[a,d]=useState(),[p,u]=useState(),[m,f]=useState(!1),L=useCallback(()=>{var M,b;try{if(!a)return;let y=a.getZoom()??l,v=a.getBounds(),q=[(M=a.getCenter())==null?void 0:M.lng(),(b=a.getCenter())==null?void 0:b.lat()],E=v==null?void 0:v.getNorthEast(),P=v==null?void 0:v.getSouthWest();if(!E||!P||!v)return;let w=[P.lng(),P.lat(),E.lng(),E.lat()];R(w,g.current)||(i&&i({zoom:y,center:q,bounds:v}),g.current=w);}catch(y){console.error(y);}},[a,i]);return useEffect(()=>{o.current&&!a&&(d(new google.maps.Map(o.current,{center:n,zoom:l,...c})),u(google.maps));},[n,l,a,o,c]),useEffect(()=>{a&&(m||(s&&p&&s({map:a,maps:p,ref:o.current}),f(!0)),google.maps.event.clearListeners(a,"idle"),google.maps.event.addListener(a,"idle",L));},[m,a,p,i,s,L]),useEffect(()=>()=>{a&&google.maps.event.clearListeners(a,"idle");},[a]),jsxs(Fragment,{children:[jsx("div",{ref:o,style:r,className:"google-map",...t==null?void 0:t.reduce((M,{name:b,handler:y})=>(M[b]=y,M),{})}),e&&a&&p&&jsx(j,{map:a,maps:p,children:e})]})}var V=le;var ge=forwardRef(({apiKey:e="",libraries:r=["places","geometry"],children:n=null,loadingContent:l="Google Maps is loading",idleContent:s="Google Maps is on idle",errorContent:i="Google Maps is on error",mapMinHeight:c="unset",containerProps:t={},loadScriptExternally:o=!1,status:g="idle",scriptCallback:a=()=>{},externalApiParams:d={},...p},u)=>{let m={ready:jsx(V,{...p,children:n}),loading:l,idle:s,error:i},f=O({apiKey:e,libraries:r,loadScriptExternally:o,status:g,externalApiParams:d,callback:a});return jsx("div",{ref:u,style:{height:"100%",width:"100%",overflow:"hidden",position:"relative",minHeight:c},...t,children:m[f]||null})}),z=ge;window.googleMapsCallback=()=>{};window.google=void 0;var Be=z;

export { Be as default };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map